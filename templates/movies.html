{% extends "base.html" %}
{% block title %}Movies â€” Rewinder{% endblock %}
{% block body %}
{% include "partials/nav.html" %}
<main>
    <div class="page-header">
        <h2>Movies</h2>
        <label class="toggle">
            <input type="checkbox"
                   {% if show_marked %}checked{% endif %}
                   hx-get="/movies"
                   hx-target="main"
                   hx-select="main"
                   hx-swap="outerHTML"
                   data-sort-by="{{ sort_by }}"
                   data-sort-dir="{{ sort_dir }}"
                   hx-vals='js:{"show_marked": event.target.checked ? "true" : "false", "sort": event.target.dataset.sortBy, "dir": event.target.dataset.sortDir}'
                   hx-push-url="true">
            Show marked
        </label>
    </div>
    <div class="sort-controls">
        Sort:
        <a href="/movies?show_marked={% if show_marked %}true{% else %}false{% endif %}&sort=name&dir={% if sort_by == "name" && sort_dir == "asc" %}desc{% else %}asc{% endif %}" class="{% if sort_by == "name" %}active{% endif %}">Title</a>
        <a href="/movies?show_marked={% if show_marked %}true{% else %}false{% endif %}&sort=year&dir={% if sort_by == "year" && sort_dir == "asc" %}desc{% else %}asc{% endif %}" class="{% if sort_by == "year" %}active{% endif %}">Year</a>
        <a href="/movies?show_marked={% if show_marked %}true{% else %}false{% endif %}&sort=added&dir={% if sort_by == "added" && sort_dir == "asc" %}desc{% else %}asc{% endif %}" class="{% if sort_by == "added" %}active{% endif %}">Added</a>
        {% if is_admin %}
        <a href="/movies?show_marked={% if show_marked %}true{% else %}false{% endif %}&sort=marked&dir={% if sort_by == "marked" && sort_dir == "asc" %}desc{% else %}asc{% endif %}" class="{% if sort_by == "marked" %}active{% endif %}">Marked</a>
        {% endif %}
    </div>
    <div class="media-grid">
        {% for item in items %}
        {% include "partials/media_card.html" %}
        {% endfor %}
    </div>
    {% if items.len() == 0 %}
    <p class="empty">No movies found</p>
    {% endif %}
</main>
{% endblock %}
