<tr id="media-{{ item.media.id }}">
    <td>
        {{ item.media.title }}
        {% if item.persisted && item.persisted_by_me %}
        <span class="pill">Persisted by you</span>
        {% endif %}
    </td>
    {% if item.media.media_type == "movie" %}
    <td>{% match item.media.year %}{% when Some with (y) %}{{ y }}{% when None %}{% endmatch %}</td>
    {% else %}
    <td>Season {% match item.media.season %}{% when Some with (s) %}{{ s }}{% when None %}0{% endmatch %}</td>
    {% endif %}
    <td>{{ item.media.first_seen }}</td>
    <td>{{ crate::templates::format_size(item.media.size_bytes) }}</td>
    {% if is_admin %}
    <td>{{ item.mark_count }} / {{ item.total_users }}</td>
    {% endif %}
    <td>
        <div class="row-actions">
        {% if item.persisted && item.persisted_by_me %}
        <button class="btn btn-sm btn-outline"
                hx-delete="/{% if item.media.media_type == "movie" %}movies{% else %}tv{% endif %}/{{ item.media.id }}/persist"
                hx-target="#media-{{ item.media.id }}"
                hx-swap="outerHTML">
            Unpersist
        </button>
        {% else if item.marked %}
        <button class="btn btn-sm btn-outline"
                hx-delete="/{% if item.media.media_type == "movie" %}movies{% else %}tv{% endif %}/{{ item.media.id }}/mark"
                hx-target="#media-{{ item.media.id }}"
                hx-swap="outerHTML">
            Unmark
        </button>
        <button class="btn btn-sm btn-success"
                hx-post="/{% if item.media.media_type == "movie" %}movies{% else %}tv{% endif %}/{{ item.media.id }}/persist"
                hx-target="#media-{{ item.media.id }}"
                hx-swap="outerHTML">
            Persist
        </button>
        {% else %}
        <button class="btn btn-sm btn-primary"
                hx-post="/{% if item.media.media_type == "movie" %}movies{% else %}tv{% endif %}/{{ item.media.id }}/mark"
                hx-target="#media-{{ item.media.id }}"
                hx-swap="outerHTML">
            Mark Done
        </button>
        <button class="btn btn-sm btn-success"
                hx-post="/{% if item.media.media_type == "movie" %}movies{% else %}tv{% endif %}/{{ item.media.id }}/persist"
                hx-target="#media-{{ item.media.id }}"
                hx-swap="outerHTML">
            Persist
        </button>
        {% endif %}
        </div>
    </td>
</tr>
